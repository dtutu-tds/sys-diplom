import{r as w,R as J,p as F,b as s,j as d,B as _,x as O,a2 as Ue,a3 as He,a4 as xe,a5 as Ge,c as C,d as D,a6 as Ke,a7 as Ve,N as R,a8 as Ye,a9 as Ce,aa as oe,Q as Oe,g as se,L as Ze,E as V,ab as Qe,ac as Xe,ad as ee,O as Je,ae as Pe,af as ie,ag as ae,ah as et,ai as tt,u as Y,aj as nt,ak as ke,al as rt,C as Ee,S as le,am as ot,an as st,ao as it,ap as at,aq as ct}from"./index-c92a9b72.js";import{C as te,B as ue}from"./BaseModal-e3fcd182.js";import{F as lt,p as ut,A as dt,I as ht}from"./Fab-2e26db57.js";import{R as ft,T as pt}from"./TextFitler-b77d0167.js";import{f as vt}from"./index-84fa0cb3.js";import{R as mt}from"./rotate-cw-7cb5d9bc.js";import{S as yt}from"./Select-0c99e0c4.js";import"./debounce-c1ba2006.js";function ne(){return ne=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},ne.apply(this,arguments)}function _t(e,t){if(e==null)return{};var n=bt(e,t),r,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)r=i[o],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function bt(e,t){if(e==null)return{};var n={},r=Object.keys(e),o,i;for(i=0;i<r.length;i++)o=r[i],!(t.indexOf(o)>=0)&&(n[o]=e[o]);return n}var ce=w.forwardRef(function(e,t){var n=e.color,r=n===void 0?"currentColor":n,o=e.size,i=o===void 0?24:o,a=_t(e,["color","size"]);return J.createElement("svg",ne({ref:t,xmlns:"http://www.w3.org/2000/svg",width:i,height:i,viewBox:"0 0 24 24",fill:"none",stroke:r,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},a),J.createElement("polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2"}))});ce.propTypes={color:F.string,size:F.oneOfType([F.string,F.number])};ce.displayName="Zap";const B=ce,gt="_FlexCenter_1380a_1",wt={FlexCenter:gt};function xt({children:e}){return s("div",{className:wt.FlexCenter,children:e})}const{useRef:de,useEffect:Ct}=O;function Ot({onClickPrimaryButton:e,onClickSecondaryButton:t}){const n=de(null),r=de(null);return Ct(()=>{n.current.focus()},[]),d("div",{onKeyDown:i=>{i.keyCode===39?r.current.focus():i.keyCode===37&&n.current.focus()},children:[s("h2",{children:"Close Connections?"}),s("p",{children:"Click 'Yes' to close those connections that are still using the old selected proxy in this group"}),s("div",{style:{height:30}}),d(xt,{children:[s(_,{onClick:e,ref:n,children:"Yes"}),s("div",{style:{width:20}}),s(_,{onClick:t,ref:r,children:"No"})]})]})}const Pt="_header_19ilz_1",kt="_arrow_19ilz_9",Et="_isOpen_19ilz_14",Tt="_btn_19ilz_21",St="_qty_19ilz_26",he={header:Pt,arrow:kt,isOpen:Et,btn:Tt,qty:St};function Te({name:e,type:t,toggle:n,qty:r}){const o=w.useCallback(i=>{i.preventDefault(),(i.key==="Enter"||i.key===" ")&&n()},[n]);return d("div",{className:he.header,onClick:n,style:{cursor:"pointer"},tabIndex:0,onKeyDown:o,role:"button",children:[s("div",{children:s(Ue,{name:e,type:t})}),typeof r=="number"?s("span",{className:he.qty,children:r}):null]})}const{useMemo:Lt}=O;function Rt(e,t){return e.filter(n=>{const r=t[n];return r===void 0?!0:r.number!==0})}const j=(e,t)=>{if(e&&typeof e.number=="number"&&e.number>0)return e.number;const n=t&&t.type;return n&&Ge.indexOf(n)>-1?-1:999999},At={Natural:e=>e,LatencyAsc:(e,t,n)=>e.sort((r,o)=>{const i=j(t[r],n&&n[r]),a=j(t[o],n&&n[o]);return i-a}),LatencyDesc:(e,t,n)=>e.sort((r,o)=>{const i=j(t[r],n&&n[r]);return j(t[o],n&&n[o])-i}),NameAsc:e=>e.sort(),NameDesc:e=>e.sort((t,n)=>t>n?-1:t<n?1:0)};function Dt(e,t){const n=t.toLowerCase().split(" ").map(r=>r.trim()).filter(r=>!!r);return n.length===0?e:e.filter(r=>{let o=0;for(;o<n.length;o++){const i=n[o];if(r.toLowerCase().indexOf(i)>-1)return!0}return!1})}function Nt(e,t,n,r,o,i){let a=[...e];return n&&(a=Rt(e,t)),typeof r=="string"&&r!==""&&(a=Dt(a,r)),At[o](a,t,i)}function Se(e,t,n,r,o){const[i]=He(xe);return Lt(()=>Nt(e,t,n,i,r,o),[e,t,n,i,r,o])}const Mt="_header_1qjca_1",Bt="_group_1qjca_5",zt="_zapWrapper_1qjca_12",$t="_arrow_1qjca_20",Ft="_isOpen_1qjca_25",b={header:Mt,group:Bt,zapWrapper:zt,arrow:$t,isOpen:Ft},Le={Right:39,Left:37,Enter:13,Space:32},jt="_proxy_xgbmr_4",It="_now_xgbmr_25",Wt="_error_xgbmr_29",qt="_selectable_xgbmr_32",Ut="_proxyType_xgbmr_40",Ht="_udpType_xgbmr_50",Gt="_tfoType_xgbmr_61",Kt="_row_xgbmr_65",Vt="_proxyName_xgbmr_73",Yt="_proxySmall_xgbmr_84",y={proxy:jt,now:It,error:Wt,selectable:qt,proxyType:Ut,udpType:Ht,tfoType:Gt,row:Kt,proxyName:Vt,proxySmall:Yt},Zt="_proxyLatency_hhwm9_4",Qt="_clickable_hhwm9_28",Xt="_placeholder_hhwm9_39",Jt="_testing_hhwm9_43",en="_proxyLatencyPulse_hhwm9_1",I={proxyLatency:Zt,clickable:Qt,placeholder:Xt,testing:Jt,proxyLatencyPulse:en};function tn({number:e,color:t,isTesting:n,error:r,onClick:o}){const i=typeof e=="number",a=n?"Testing...":i?`${e} ms`:r||"--",c=C(I.proxyLatency,{[I.clickable]:Boolean(o),[I.placeholder]:!i||Boolean(r),[I.testing]:n}),u=w.useCallback(l=>{!o||n||(l.preventDefault(),l.stopPropagation(),o())},[n,o]),p=w.useCallback(l=>{!o||n||(l.key==="Enter"||l.key===" ")&&(l.preventDefault(),l.stopPropagation(),o())},[n,o]);return s("span",{className:c,style:{color:i?t:void 0},role:o?"button":void 0,tabIndex:o?0:void 0,onClick:u,onKeyDown:p,title:a,children:s("span",{children:a})})}const{useMemo:U}=O,M={good:"#67c23a",normal:"#d4b75c",bad:"#e67f3c",na:"#909399"};function Re({number:e}={},t){const n={good:t?800:200,normal:t?1500:500};return e===0?M.na:e<n.good?M.good:e<n.normal?M.normal:typeof e=="number"?M.bad:M.na}function nn(e,t){return Re(e,t)}function rn({now:e,name:t,proxy:n,latency:r,httpsLatencyTest:o,isSelectable:i,onClick:a}){var v;const c=(v=n.history[n.history.length-1])==null?void 0:v.delay,u=(r==null?void 0:r.number)??c,p=U(()=>nn({number:u},o),[u,o]),l=U(()=>{let f=t;return r&&typeof r.number=="number"&&(f+=" "+r.number+" ms"),f},[t,r]),h=w.useCallback(()=>{i&&a&&a(t)},[t,a,i]),m=w.useCallback(f=>{f.keyCode===Le.Enter&&h()},[h]);return s("div",{title:l,className:C(y.proxySmall,{[y.selectable]:i}),style:{background:p,scale:e?"1.2":"1"},onClick:h,onKeyDown:m,role:i?"menuitem":"",children:e&&s("div",{className:y.now})})}function on(e){return e==="Shadowsocks"?"SS":e}const sn=e=>({left:e.left+window.scrollX-5,top:e.top+window.scrollY-38});function an({children:e,label:t,"aria-label":n}){const[r,o]=Ve();return d(R,{children:[w.cloneElement(e,r),s(Ye,{...o,label:t,"aria-label":n,position:sn})]})}function cn({now:e,name:t,proxy:n,latency:r,httpsLatencyTest:o,isSelectable:i,onClick:a,apiConfig:c,dispatch:u}){var E;const p=(E=n.history[n.history.length-1])==null?void 0:E.delay,l=typeof(r==null?void 0:r.number)=="number"?r.number:typeof p=="number"?p:void 0,h=typeof l=="number"&&l>0,m=U(()=>Re({number:h?l:void 0},o),[h,l,o]),v=Boolean(r==null?void 0:r.testing),f=w.useCallback(()=>{i&&a&&a(t)},[t,a,i]);function k(g,L){return g?L?"XUDP":"UDP":""}function T(g){return g?s("svg",{viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"2962",width:"10",height:"10",children:s("path",{d:"M648.093513 719.209284l-1.492609-40.940127 31.046263-26.739021c202.73892-174.805813 284.022131-385.860697 255.70521-561.306199-176.938111-28.786027-389.698834 51.857494-563.907604 254.511123l-26.31256 30.619803-40.38573-0.938211c-60.557271-1.407317-111.903014 12.79379-162.822297 47.0385l189.561318 127.084977-37.95491 68.489421c-9.126237 16.461343-0.554398 53.307457 29.084549 82.818465 29.5963 29.511008 67.380626 38.381369 83.287571 29.852176l68.318836-36.760822 127.639376 191.267156c36.163779-52.11337 50.450177-103.629696 48.189941-165.039887zM994.336107 16.105249l10.490908 2.686696 2.64405 10.405615c47.46496 178.089552-1.023503 451.492838-274.170913 686.898568 4.051367 111.263324-35.396151 200.222809-127.255561 291.741051l-15.779008 15.693715-145.934494-218.731157c-51.217805 27.59194-128.790816 10.405616-183.93205-44.522388-55.226525-55.013296-72.41285-132.287785-43.498885-184.529093L0.002773 430.325513l15.736362-15.65107c89.300652-88.959484 178.64395-128.108481 289.011709-125.549722C539.730114 15.806727 815.56422-31.061189 994.336107 16.105249zM214.93844 805.098259c28.572797 28.572797 22.346486 79.49208-12.537914 114.376479C156.428175 965.489735 34.034254 986.002445 34.034254 986.002445s25.331704-127.084978 66.612998-168.323627c34.8844-34.8844 85.633099-41.281295 114.291188-12.580559zM661.01524 298.549479a63.968948 63.968948 0 1 0 0 127.937897 63.968948 63.968948 0 0 0 0-127.937897z","p-id":"2963"})}):""}const P=w.useCallback(g=>{g.keyCode===Le.Enter&&f()},[f]),N=U(()=>C(y.proxy,{[y.now]:e,[y.error]:r&&r.error,[y.selectable]:i}),[i,e,r]),S=w.useCallback(()=>{v||u(Ke(c,t))},[c,u,v,t]);return d("div",{tabIndex:0,className:N,onClick:f,onKeyDown:P,role:i?"menuitem":"",children:[d("div",{className:C(y.proxyName,y.row),children:[s(an,{label:t,"aria-label":`proxy name: ${t}`,children:s("span",{children:t})}),s("span",{className:y.proxyType,style:{paddingLeft:4,opacity:.6,color:"#51A8DD"},children:k(n.udp,n.xudp)})]}),d("div",{className:y.row,children:[d("div",{className:y.row,children:[s("span",{className:y.proxyType,style:{paddingRight:4,opacity:.6,color:"#F596AA"},children:on(n.type)}),T(n.tfo)]}),s(tn,{number:h?l:void 0,color:m,isTesting:v,error:r==null?void 0:r.error,onClick:S})]})]})}const Ae=(e,{name:t})=>{const n=Ce(e),r=oe(e),o=Oe(e);return{proxy:n[t]||{name:t,history:[]},latency:r[t],httpsLatencyTest:o.startsWith("https://"),apiConfig:se(e)}},ln=D(Ae)(cn),un=D(Ae)(rn),dn="_list_4awfc_4",hn="_detail_4awfc_10",fn="_summary_4awfc_19",H={list:dn,detail:hn,summary:fn};function De({all:e,now:t,isSelectable:n,itemOnTapCallback:r}){const o=e;return s("div",{className:C(H.list,H.detail),children:o.map(i=>s(ln,{onClick:r,isSelectable:n,name:i,now:i===t},i))})}function Ne({all:e,now:t,isSelectable:n,itemOnTapCallback:r}){return s("div",{className:C(H.list,H.summary),children:e.map(o=>s(un,{onClick:r,isSelectable:n,name:o,now:o===t},o))})}const{createElement:pn,useCallback:Q,useMemo:vn,useState:fe,useEffect:mn}=O;function pe(){return s("div",{className:b.zapWrapper,children:s(B,{size:16})})}function yn({name:e,all:t,delay:n,hideUnavailableProxies:r,proxySortBy:o,proxies:i,type:a,now:c,isOpen:u,latencyTestUrl:p,apiConfig:l,dispatch:h}){const m=Se(t,n,r,o,i),{data:v}=Ze(["/version",l],()=>Je("/version",l)),f=vn(()=>["Selector",v.meta&&"Fallback",v.meta&&"URLTest"].includes(a),[a,v.meta]),{app:{updateCollapsibleIsOpen:k},proxies:{requestDelayForProxies:T}}=V(),P=Q(()=>{k("proxyGroup",e,!u)},[u,k,e]),N=Q($=>{f&&h(Qe(l,e,$))},[l,h,e,f]),[S,E]=fe(!1),g=Q(async()=>{E(!0);try{v.meta===!0?(await Xe(l,e,p),await h(ee(l))):(await T(l,m),await h(ee(l)))}catch{}E(!1)},[m,l,h,e,v.meta]),[L,x]=fe(window.innerWidth),z=()=>{x(window.innerWidth)};return mn(()=>(window.addEventListener("resize",z),()=>window.removeEventListener("resize",z)),[]),d("div",{className:b.group,children:[d("div",{style:{display:"flex",alignItems:"center",justifyContent:L>768?"start":"space-between"},children:[s(Te,{name:e,type:a,toggle:P,qty:m.length}),s("div",{style:{display:"flex"},children:L>768?d(R,{children:[s(_,{kind:"minimal",onClick:P,className:b.btn,title:"Toggle collapsible section",children:s("span",{className:C(b.arrow,{[b.isOpen]:u}),children:s(te,{size:20})})}),s(_,{title:"Test latency",kind:"minimal",onClick:g,isLoading:S,children:s(pe,{})})]}):d(R,{children:[s(_,{title:"Test latency",kind:"minimal",onClick:g,isLoading:S,children:s(pe,{})}),s(_,{kind:"minimal",onClick:P,className:b.btn,title:"Toggle collapsible section",children:s("span",{className:C(b.arrow,{[b.isOpen]:u}),children:s(te,{size:20})})})]})})]}),pn(u?De:Ne,{all:m,now:c,isSelectable:f,itemOnTapCallback:N})]})}const _n=D((e,{name:t,delay:n})=>{const r=Ce(e),o=Pe(e),i=ie(e),a=ae(e),c=Oe(e),u=r[t],{all:p,type:l,now:h}=u;return{all:p,delay:n,hideUnavailableProxies:a,proxySortBy:i,proxies:r,type:l,now:h,isOpen:o[`proxyGroup:${t}`],latencyTestUrl:c}})(yn),{useCallback:Me,useState:bn}=O;function gn({dispatch:e,apiConfig:t,name:n}){return Me(()=>e(et(t,n)),[t,e,n])}function wn({dispatch:e,apiConfig:t,names:n}){const[r,o]=bn(!1);return[Me(async()=>{if(!r){o(!0);try{await e(tt(t,n))}catch{}o(!1)}},[t,e,n,r]),r]}const{useState:xn,useCallback:Cn}=O;function On({isLoading:e}){return e?s(ht,{children:s(B,{width:16,height:16})}):s(B,{width:16,height:16})}function Pn({dispatch:e,apiConfig:t}){const[n,r]=xn(!1);return[Cn(()=>{n||(r(!0),e(nt(t)).then(()=>r(!1),()=>r(!1)))},[t,e,n]),n]}function kn({dispatch:e,apiConfig:t,proxyProviders:n}){const{t:r}=Y(),[o,i]=Pn({dispatch:e,apiConfig:t}),[a,c]=wn({apiConfig:t,dispatch:e,names:n.map(u=>u.name)});return s(lt,{icon:s(On,{isLoading:i}),onClick:o,text:r("Test Latency"),style:ut,children:n.length>0?s(dt,{text:r("update_all_proxy_provider"),onClick:a,children:s(ft,{isRotating:c})}):null})}var Be=function(){if(typeof Map<"u")return Map;function e(t,n){var r=-1;return t.some(function(o,i){return o[0]===n?(r=i,!0):!1}),r}return function(){function t(){this.__entries__=[]}return Object.defineProperty(t.prototype,"size",{get:function(){return this.__entries__.length},enumerable:!0,configurable:!0}),t.prototype.get=function(n){var r=e(this.__entries__,n),o=this.__entries__[r];return o&&o[1]},t.prototype.set=function(n,r){var o=e(this.__entries__,n);~o?this.__entries__[o][1]=r:this.__entries__.push([n,r])},t.prototype.delete=function(n){var r=this.__entries__,o=e(r,n);~o&&r.splice(o,1)},t.prototype.has=function(n){return!!~e(this.__entries__,n)},t.prototype.clear=function(){this.__entries__.splice(0)},t.prototype.forEach=function(n,r){r===void 0&&(r=null);for(var o=0,i=this.__entries__;o<i.length;o++){var a=i[o];n.call(r,a[1],a[0])}},t}()}(),re=typeof window<"u"&&typeof document<"u"&&window.document===document,G=function(){return typeof global<"u"&&global.Math===Math?global:typeof self<"u"&&self.Math===Math?self:typeof window<"u"&&window.Math===Math?window:Function("return this")()}(),En=function(){return typeof requestAnimationFrame=="function"?requestAnimationFrame.bind(G):function(e){return setTimeout(function(){return e(Date.now())},1e3/60)}}(),Tn=2;function Sn(e,t){var n=!1,r=!1,o=0;function i(){n&&(n=!1,e()),r&&c()}function a(){En(i)}function c(){var u=Date.now();if(n){if(u-o<Tn)return;r=!0}else n=!0,r=!1,setTimeout(a,t);o=u}return c}var Ln=20,Rn=["top","right","bottom","left","width","height","size","weight"],An=typeof MutationObserver<"u",Dn=function(){function e(){this.connected_=!1,this.mutationEventsAdded_=!1,this.mutationsObserver_=null,this.observers_=[],this.onTransitionEnd_=this.onTransitionEnd_.bind(this),this.refresh=Sn(this.refresh.bind(this),Ln)}return e.prototype.addObserver=function(t){~this.observers_.indexOf(t)||this.observers_.push(t),this.connected_||this.connect_()},e.prototype.removeObserver=function(t){var n=this.observers_,r=n.indexOf(t);~r&&n.splice(r,1),!n.length&&this.connected_&&this.disconnect_()},e.prototype.refresh=function(){var t=this.updateObservers_();t&&this.refresh()},e.prototype.updateObservers_=function(){var t=this.observers_.filter(function(n){return n.gatherActive(),n.hasActive()});return t.forEach(function(n){return n.broadcastActive()}),t.length>0},e.prototype.connect_=function(){!re||this.connected_||(document.addEventListener("transitionend",this.onTransitionEnd_),window.addEventListener("resize",this.refresh),An?(this.mutationsObserver_=new MutationObserver(this.refresh),this.mutationsObserver_.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})):(document.addEventListener("DOMSubtreeModified",this.refresh),this.mutationEventsAdded_=!0),this.connected_=!0)},e.prototype.disconnect_=function(){!re||!this.connected_||(document.removeEventListener("transitionend",this.onTransitionEnd_),window.removeEventListener("resize",this.refresh),this.mutationsObserver_&&this.mutationsObserver_.disconnect(),this.mutationEventsAdded_&&document.removeEventListener("DOMSubtreeModified",this.refresh),this.mutationsObserver_=null,this.mutationEventsAdded_=!1,this.connected_=!1)},e.prototype.onTransitionEnd_=function(t){var n=t.propertyName,r=n===void 0?"":n,o=Rn.some(function(i){return!!~r.indexOf(i)});o&&this.refresh()},e.getInstance=function(){return this.instance_||(this.instance_=new e),this.instance_},e.instance_=null,e}(),ze=function(e,t){for(var n=0,r=Object.keys(t);n<r.length;n++){var o=r[n];Object.defineProperty(e,o,{value:t[o],enumerable:!1,writable:!1,configurable:!0})}return e},A=function(e){var t=e&&e.ownerDocument&&e.ownerDocument.defaultView;return t||G},$e=Z(0,0,0,0);function K(e){return parseFloat(e)||0}function ve(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return t.reduce(function(r,o){var i=e["border-"+o+"-width"];return r+K(i)},0)}function Nn(e){for(var t=["top","right","bottom","left"],n={},r=0,o=t;r<o.length;r++){var i=o[r],a=e["padding-"+i];n[i]=K(a)}return n}function Mn(e){var t=e.getBBox();return Z(0,0,t.width,t.height)}function Bn(e){var t=e.clientWidth,n=e.clientHeight;if(!t&&!n)return $e;var r=A(e).getComputedStyle(e),o=Nn(r),i=o.left+o.right,a=o.top+o.bottom,c=K(r.width),u=K(r.height);if(r.boxSizing==="border-box"&&(Math.round(c+i)!==t&&(c-=ve(r,"left","right")+i),Math.round(u+a)!==n&&(u-=ve(r,"top","bottom")+a)),!$n(e)){var p=Math.round(c+i)-t,l=Math.round(u+a)-n;Math.abs(p)!==1&&(c-=p),Math.abs(l)!==1&&(u-=l)}return Z(o.left,o.top,c,u)}var zn=function(){return typeof SVGGraphicsElement<"u"?function(e){return e instanceof A(e).SVGGraphicsElement}:function(e){return e instanceof A(e).SVGElement&&typeof e.getBBox=="function"}}();function $n(e){return e===A(e).document.documentElement}function Fn(e){return re?zn(e)?Mn(e):Bn(e):$e}function jn(e){var t=e.x,n=e.y,r=e.width,o=e.height,i=typeof DOMRectReadOnly<"u"?DOMRectReadOnly:Object,a=Object.create(i.prototype);return ze(a,{x:t,y:n,width:r,height:o,top:n,right:t+r,bottom:o+n,left:t}),a}function Z(e,t,n,r){return{x:e,y:t,width:n,height:r}}var In=function(){function e(t){this.broadcastWidth=0,this.broadcastHeight=0,this.contentRect_=Z(0,0,0,0),this.target=t}return e.prototype.isActive=function(){var t=Fn(this.target);return this.contentRect_=t,t.width!==this.broadcastWidth||t.height!==this.broadcastHeight},e.prototype.broadcastRect=function(){var t=this.contentRect_;return this.broadcastWidth=t.width,this.broadcastHeight=t.height,t},e}(),Wn=function(){function e(t,n){var r=jn(n);ze(this,{target:t,contentRect:r})}return e}(),qn=function(){function e(t,n,r){if(this.activeObservations_=[],this.observations_=new Be,typeof t!="function")throw new TypeError("The callback provided as parameter 1 is not a function.");this.callback_=t,this.controller_=n,this.callbackCtx_=r}return e.prototype.observe=function(t){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if(!(typeof Element>"u"||!(Element instanceof Object))){if(!(t instanceof A(t).Element))throw new TypeError('parameter 1 is not of type "Element".');var n=this.observations_;n.has(t)||(n.set(t,new In(t)),this.controller_.addObserver(this),this.controller_.refresh())}},e.prototype.unobserve=function(t){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if(!(typeof Element>"u"||!(Element instanceof Object))){if(!(t instanceof A(t).Element))throw new TypeError('parameter 1 is not of type "Element".');var n=this.observations_;n.has(t)&&(n.delete(t),n.size||this.controller_.removeObserver(this))}},e.prototype.disconnect=function(){this.clearActive(),this.observations_.clear(),this.controller_.removeObserver(this)},e.prototype.gatherActive=function(){var t=this;this.clearActive(),this.observations_.forEach(function(n){n.isActive()&&t.activeObservations_.push(n)})},e.prototype.broadcastActive=function(){if(this.hasActive()){var t=this.callbackCtx_,n=this.activeObservations_.map(function(r){return new Wn(r.target,r.broadcastRect())});this.callback_.call(t,n,t),this.clearActive()}},e.prototype.clearActive=function(){this.activeObservations_.splice(0)},e.prototype.hasActive=function(){return this.activeObservations_.length>0},e}(),Fe=typeof WeakMap<"u"?new WeakMap:new Be,je=function(){function e(t){if(!(this instanceof e))throw new TypeError("Cannot call a class as a function.");if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");var n=Dn.getInstance(),r=new qn(t,n,this);Fe.set(this,r)}return e}();["observe","unobserve","disconnect"].forEach(function(e){je.prototype[e]=function(){var t;return(t=Fe.get(this))[e].apply(t,arguments)}});var Un=function(){return typeof G.ResizeObserver<"u"?G.ResizeObserver:je}();const{memo:Hn,useState:Gn,useRef:Ie,useEffect:We}=J;function Kn(e){const t=Ie();return We(()=>void(t.current=e),[e]),t.current}function Vn(){const e=Ie(),[t,n]=Gn({height:0});return We(()=>{const r=new Un(([o])=>n(o.contentRect));return e.current&&r.observe(e.current),()=>r.disconnect()},[]),[e,t]}const Yn={initialOpen:{height:"auto",transition:{duration:0}},open:e=>({height:e,opacity:1,visibility:"visible",transition:{duration:.3}}),closed:{height:0,opacity:0,visibility:"hidden",overflowY:"hidden",transition:{duration:.3}}},Zn={open:{},closed:{}},me=Hn(({children:e,isOpen:t})=>{const r=ke.read().motion,o=Kn(t),[i,{height:a}]=Vn();return s("div",{children:s(r.div,{animate:t&&o===t?"initialOpen":t?"open":"closed",custom:a,variants:Yn,children:s(r.div,{variants:Zn,ref:i,children:e})})})}),Qn="_updatedAt_1d817_4",Xn="_body_1d817_12",Jn="_actionFooter_1d817_25",er="_refresh_1d817_35",q={updatedAt:Qn,body:Xn,actionFooter:Jn,refresh:er},{useState:tr,useCallback:ye}=O;function nr({name:e,proxies:t,delay:n,hideUnavailableProxies:r,proxySortBy:o,vehicleType:i,updatedAt:a,subscriptionInfo:c,isOpen:u,dispatch:p,apiConfig:l}){const h=Se(t,n,r,o),[m,v]=tr(!1),f=gn({dispatch:p,apiConfig:l,name:e}),k=ye(async()=>{v(!0),await p(rt(l,e)),v(!1)},[l,p,e,v]),{app:{updateCollapsibleIsOpen:T}}=V(),P=ye(()=>{T("proxyProvider",e,!u)},[u,T,e]),N=vt(new Date(a),new Date),S=c?_e(c.Total):0,E=c?_e(c.Download+c.Upload):0,g=c?((c.Download+c.Upload)/c.Total*100).toFixed(2):0,L=()=>{if(c.Expire===0)return"Null";const x=new Date(c.Expire*1e3),z=x.getFullYear()+"-",$=(x.getMonth()+1<10?"0"+(x.getMonth()+1):x.getMonth()+1)+"-",qe=(x.getDate()<10?"0"+x.getDate():x.getDate())+" ";return z+$+qe};return d("div",{className:q.body,children:[d("div",{style:{display:"flex",alignItems:"center",flexWrap:"wrap",justifyContent:"space-between"},children:[s(Te,{name:e,toggle:P,type:i,isOpen:u,qty:h.length}),d("div",{style:{display:"flex"},children:[s(_,{kind:"minimal",onClick:P,className:b.btn,title:"Toggle collapsible section",children:s("span",{className:C(b.arrow,{[b.isOpen]:u}),children:s(te,{size:20})})}),s(_,{kind:"minimal",start:s(be,{}),onClick:f}),s(_,{kind:"minimal",start:s(B,{size:16}),onClick:k,isLoading:m})]})]}),d("div",{className:q.updatedAt,children:[c&&d("small",{children:[E," / ",S," ( ",g,"% )    Expire: ",L()," "]}),s("br",{}),d("small",{children:["Updated ",N," ago"]})]}),d(me,{isOpen:u,children:[s(De,{all:h}),d("div",{className:q.actionFooter,children:[s(_,{text:"Update",start:s(be,{}),onClick:f}),s(_,{text:"Health Check",start:s(B,{size:16}),onClick:k,isLoading:m})]})]}),s(me,{isOpen:!u,children:s(Ne,{all:h})})]})}const rr={rest:{scale:1},pressed:{scale:.95}},or={rest:{rotate:0},hover:{rotate:360,transition:{duration:.3}}};function _e(e,t=2){if(!+e)return"0 Bytes";const n=1024,r=t<0?0:t,o=["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"],i=Math.floor(Math.log(e)/Math.log(n));return`${parseFloat((e/Math.pow(n,i)).toFixed(r))} ${o[i]}`}function be(){const t=ke.read().motion;return s(t.div,{className:q.refresh,variants:rr,initial:"rest",whileHover:"hover",whileTap:"pressed",children:s(t.div,{className:"flexCenter",variants:or,children:s(mt,{size:16})})})}const sr=(e,{proxies:t,name:n})=>{const r=ae(e),o=oe(e),i=Pe(e),a=se(e),c=ie(e);return{apiConfig:a,proxies:t,delay:o,hideUnavailableProxies:r,proxySortBy:c,isOpen:i[`proxyProvider:${n}`]}},ir=D(sr)(nr);function ar({items:e}){const{t}=Y();return e.length===0?null:d(R,{children:[s(Ee,{title:t("proxy_provider")}),s("div",{children:e.map(n=>s(ir,{name:n.name,proxies:n.proxies,type:n.type,vehicleType:n.vehicleType,updatedAt:n.updatedAt,subscriptionInfo:n.subscriptionInfo},n.name))})]})}const cr="_labeledInput_cmki0_1",X={labeledInput:cr},lr=[["Natural","order_natural"],["LatencyAsc","order_latency_asc"],["LatencyDesc","order_latency_desc"],["NameAsc","order_name_asc"],["NameDesc","order_name_desc"]],{useCallback:ge}=O;function ur({appConfig:e}){const{app:{updateAppConfig:t}}=V(),n=ge(i=>{t("proxySortBy",i.target.value)},[t]),r=ge(i=>{t("hideUnavailableProxies",i)},[t]),{t:o}=Y();return d(R,{children:[d("div",{className:X.labeledInput,children:[s("span",{children:o("sort_in_grp")}),s("div",{children:s(yt,{options:lr.map(i=>[i[0],o(i[1])]),selected:e.proxySortBy,onChange:n})})]}),s("hr",{}),d("div",{className:X.labeledInput,children:[s("span",{children:o("hide_unavail_proxies")}),s("div",{children:s(le,{name:"hideUnavailableProxies",checked:e.hideUnavailableProxies,onChange:r})})]}),d("div",{className:X.labeledInput,children:[s("span",{children:o("auto_close_conns")}),s("div",{children:s(le,{name:"autoCloseOldConns",checked:e.autoCloseOldConns,onChange:i=>t("autoCloseOldConns",i)})})]})]})}const dr=e=>{const t=ie(e),n=ae(e),r=ot(e);return{appConfig:{proxySortBy:t,hideUnavailableProxies:n,autoCloseOldConns:r}}},hr=D(dr)(ur);function fr({color:e="currentColor",size:t=24}){return d("svg",{fill:"none",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:t,height:t,stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[s("path",{d:"M2 6h9M18.5 6H22"}),s("circle",{cx:"16",cy:"6",r:"2"}),s("path",{d:"M22 18h-9M6 18H2"}),s("circle",{r:"2",transform:"matrix(-1 0 0 1 8 18)"})]})}const pr="_topBar_15n7g_4",vr="_topBarRight_15n7g_16",mr="_textFilterContainer_15n7g_25",yr="_group_15n7g_32",W={topBar:pr,topBarRight:vr,textFilterContainer:mr,group:yr},{useState:_r,useEffect:br,useCallback:we,useRef:gr}=O;function wr({dispatch:e,groupNames:t,delay:n,proxyProviders:r,apiConfig:o,showModalClosePrevConns:i}){const a=gr({}),c=we(()=>{a.current.startAt=Date.now(),e(ee(o)).then(()=>{a.current.completeAt=Date.now()})},[o,e]);br(()=>{c();const f=()=>{a.current.startAt&&Date.now()-a.current.startAt>3e4&&c()};return window.addEventListener("focus",f,!1),()=>window.removeEventListener("focus",f,!1)},[c]);const[u,p]=_r(!1),l=we(()=>{p(!1)},[]),{proxies:{closeModalClosePrevConns:h,closePrevConnsAndTheModal:m}}=V(),{t:v}=Y();return d(R,{children:[s(ue,{isOpen:u,onRequestClose:l,children:s(hr,{})}),d("div",{className:W.topBar,children:[s(Ee,{title:v("Proxies")}),d("div",{className:W.topBarRight,children:[s("div",{className:W.textFilterContainer,children:s(pt,{textAtom:xe,placeholder:v("Search")})}),s(st,{label:v("settings"),children:s(_,{kind:"minimal",onClick:()=>p(!0),children:s(fr,{size:16})})})]})]}),s("div",{children:t.map(f=>s("div",{className:W.group,children:s(_n,{name:f,delay:n,apiConfig:o,dispatch:e})},f))}),s(ar,{items:r}),s("div",{style:{height:60}}),s(kn,{dispatch:e,apiConfig:o,proxyProviders:r}),s(ue,{isOpen:i,onRequestClose:h,children:s(Ot,{onClickPrimaryButton:()=>m(o),onClickSecondaryButton:h})})]})}const xr=e=>({apiConfig:se(e),groupNames:it(e),proxyProviders:at(e),delay:oe(e),showModalClosePrevConns:ct(e)}),Rr=D(xr)(wr);export{Rr as default};
